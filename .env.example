# ============================================
# CONFIGURAÇÃO DO SISTEMA RAG
# ============================================
# Copie este arquivo para .env e ajuste os valores conforme necessário
# cp .env.example .env

# ============================================
# AMBIENTE E SERVIDOR
# ============================================

# Ambiente de execução (development, production, test)
NODE_ENV=development

# Porta do servidor HTTP
PORT=3000

# ============================================
# RAG - PROCESSAMENTO DE DOCUMENTOS
# ============================================

# Tamanho do chunk em tokens (padrão: 1000)
CHUNK_SIZE=1000

# Sobreposição entre chunks em tokens (padrão: 200)
CHUNK_OVERLAP=200

# Modelo de embeddings (padrão: Xenova/all-MiniLM-L6-v2)
EMBEDDING_MODEL=Xenova/all-MiniLM-L6-v2

# ============================================
# OLLAMA - LLM
# ============================================

# URL do servidor Ollama
OLLAMA_URL=http://localhost:11434

# Modelo LLM a ser usado (padrão: llama3.2)
OLLAMA_MODEL=llama3.2

# Número máximo de requisições concorrentes ao Ollama (padrão: 20)
OLLAMA_MAX_CONCURRENT=20

# Timeout para requisições ao Ollama em milissegundos (padrão: 120000 = 2min)
OLLAMA_TIMEOUT_MS=120000

# Número máximo de tokens a serem gerados (padrão: 2000)
OLLAMA_NUM_PREDICT=2000

# Temperatura para geração (0.0 a 2.0, padrão: 0.7)
OLLAMA_TEMPERATURE=0.7

# Top-p sampling (0.0 a 1.0, padrão: 0.9)
OLLAMA_TOP_P=0.9

# ============================================
# ARQUIVOS
# ============================================

# Tamanho máximo de arquivo em MB (padrão: 50)
MAX_FILE_SIZE_MB=50

# ============================================
# SESSÕES E VECTOR DB
# ============================================

# Tempo máximo de vida de uma sessão em minutos (padrão: 60)
SESSION_MAX_AGE_MINUTES=60

# Intervalo de limpeza automática de sessões em minutos (padrão: 30)
SESSION_CLEANUP_INTERVAL_MINUTES=30

# Caminho do diretório da Vector DB (padrão: ./vector_db)
VECTOR_DB_PATH=./vector_db

# ============================================
# RATE LIMITING
# ============================================

# Janela de tempo do rate limit em milissegundos (padrão: 900000 = 15min)
RATE_LIMIT_WINDOW_MS=900000

# Número máximo de requisições por janela (padrão: 100)
RATE_LIMIT_MAX_REQUESTS=100

# ============================================
# REDIS (OPCIONAL - Para cache distribuído e rate limiting)
# ============================================

# Habilitar Redis (true/false, padrão: false)
REDIS_ENABLED=false

# Host do Redis (padrão: localhost)
REDIS_HOST=localhost

# Porta do Redis (padrão: 6379)
REDIS_PORT=6379

# Senha do Redis (opcional)
REDIS_PASSWORD=

# Número do banco de dados Redis (padrão: 0)
REDIS_DB=0

# ============================================
# LOGGING
# ============================================

# Nível de log (fatal, error, warn, info, debug, trace)
LOG_LEVEL=info

# ============================================
# CIRCUIT BREAKER
# ============================================

# Timeout do circuit breaker em milissegundos (padrão: 3000)
CIRCUIT_BREAKER_TIMEOUT=3000

# Percentual de erro para abrir o circuit (0-100, padrão: 50)
CIRCUIT_BREAKER_ERROR_THRESHOLD=50

# Tempo de reset do circuit breaker em milissegundos (padrão: 30000 = 30s)
CIRCUIT_BREAKER_RESET_TIMEOUT=30000

# ============================================
# NOTAS E RECOMENDAÇÕES
# ============================================
#
# 1. REDIS (Cache Distribuído e Rate Limiting):
#    - Para usar em múltiplas instâncias, configure REDIS_ENABLED=true
#    - Certifique-se de que o Redis está rodando
#    - Exemplo com Docker: docker run -d -p 6379:6379 redis:alpine
#
# 2. PRODUÇÃO:
#    - Defina NODE_ENV=production
#    - Configure LOG_LEVEL=warn ou error
#    - Configure Redis para cache e rate limiting distribuídos
#    - Ajuste OLLAMA_MAX_CONCURRENT baseado na capacidade do servidor
#
# 3. DESENVOLVIMENTO:
#    - NODE_ENV=development
#    - LOG_LEVEL=debug (para mais detalhes)
#    - REDIS_ENABLED=false (usa memória local)
#
# 4. MODELOS OLLAMA RECOMENDADOS:
#    - llama3.2 (mais rápido, boa qualidade)
#    - llama3.1 (melhor qualidade, mais lento)
#    - mistral (alternativa leve)
#
# 5. TAMANHO DE ARQUIVO:
#    - MAX_FILE_SIZE_MB=50 é suficiente para a maioria dos casos
#    - Aumente se precisar processar arquivos muito grandes
#    - Lembre-se que arquivos grandes demoram mais para processar
#
# 6. RATE LIMITING:
#    - RATE_LIMIT_WINDOW_MS=900000 (15 minutos) é um bom padrão
#    - RATE_LIMIT_MAX_REQUESTS=100 permite ~6.6 requisições/minuto
#    - Ajuste conforme necessário para seu caso de uso
#
# 7. CIRCUIT BREAKER:
#    - Protege contra falhas em cascata do Ollama
#    - CIRCUIT_BREAKER_ERROR_THRESHOLD=50 significa que se 50% das
#      requisições falharem, o circuit abre e bloqueia novas requisições
#    - CIRCUIT_BREAKER_RESET_TIMEOUT=30000 tenta resetar após 30 segundos
